---
layout : post
title : sql-4
subtitle : sql-4
category : 프로그래밍 언어 공부
tags : sql
date : 2019-04-02 20:00:00
---

(1)DB 설계

a.관계

ㄱ. 일대일 관계
예를 들어 어떤 문건을 구매하기 위해서 구매신청서를 작성해야한다 하자.
그럼 우리는 하나의 주문에 하나의 신청서를 작성해야하는데 이 때 주문과 신청서가 1대1관계이다.


ㄴ. 일대다 관계
o 제일 흔한 경우로 부모-자식 관계라고도 한다.
예를 들어 어떤 회사의 부서가 있다고 하자.
그럼 그 부서에는 여러사원을 포함하는데 이 때 부서와 사원이 1대다 관계에 있다고 한다.

o 일반적으로 정규화를 시킨다고 하는 것은 일대다 관계를 만들려고 하는 것이다.


ㄷ. 다대다 관계
o 제일 나오면 안 되는 경우로 꼭 정규화과정을 거쳐야 한다.
예를 들어 하나의 주문에는 여러 개의 제품을 포함한다.
또한 한 제품이 여러 개의 주문을 통해 주문이 된다.
이 때 주문과 제품은 다대다 관계에 있다고 한다.

ㄹ. 식별관계
부모 테이블의 pk가 자식 테이블에서도 pk로 쓰이면 식별관계이다.

ㅁ. 비식별관계
부모 테이블의 pk가 자식 테이블에 있기는 하지만 pk로 쓰이지 않았다면 비식별관계이다.


b. 정규화

ㄱ. 무엇?
데이터 베이스를 재구성하는 테크닉

ㄴ. 목적
o 불필요한 데이터를 제거한다.
o 데이터 저장을 논리적으로 하여 삽입/삭제 등을 할 때 발생할 수 있는 각종 이상현상들을 방지할 수 있다.

ㄷ.방법
o 기본적인 방향성은 테이블을 잘 쪼개서 1대 다 관계를 만드는 것.

ㄹ.종류
o 제1정규화 : 각 로우마다 칼럼의 값이 1개씩만 있어야 한다.
이것을 칼럼이 원자값을 갖는다고 합니다.
![1차정규화](/assets/1차정규화.gif)
위 테이블을 보면 adam의 과목은 두 개이다. 이는 1차정규형을 위반한 것이라 할 수 있다.
해결책은 adam을 두 번 써주는 것인데 논리성을 위해 불필요한 데이터를 추가하는 것입니다.


o  제2정규화 : 모든 키가 아닌 칼럼은 기본키 전체에 의존적이어야 한다. 기본키의 일부분에 의존적이어서는 안된다
기본키를 가진 칼럼에는 모두 종속되어 있어야 한다는 것인데 예를들어
![2차 정규화](/assets/2차%20정규화.gif)
이 테이블에서 age는 student 칼럼에만 종속되어 있는데 기본키는
student와 subject이다.
이는 student가 나올 때마다 age가 중복되서 나오는 불필요한 상황이 발생하므로 테이블을 두개로 나눈다.
![제2정규화2](/assets/제2정규화2.gif)

![제2정규화3](/assets/제2정규화3.gif)

이렇게 두 개로 나누게 되면 둘 다 제2정규형을 만족하게 된다.

o 제3정규화 : 기본키를 제외한 칼럼이 다른 칼럼을 결정할 수 없다는 것을 뜻한다.

 ![제3정규화1](/assets/제3정규화1.gif)

위 테이블을 보면 기본키는 id이다. 하지만 zip을 알면 street, city,state를 다 알 수 있다고 한다. 이는 제3정규형을 위반하는 것이다.
따라서 이를 해결하기 위해서는 2정규형과 마찬가지로 테이블을 나눈다.

![제3정규화2](/assets/제3정규화2.gif)

이렇게 나누면 zip을 하나의 기본키로 갖는 테이블로 나누면 두 테이블 모두 정규형을 만족시킨다.

c. 설계툴

ㄱ. ER-win

(2) 파이썬과 mysql의 연동

a. d
